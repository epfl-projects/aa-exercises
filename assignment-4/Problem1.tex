% Point inside a simple, not necessarily convex polygon (2D linear programming)

Suppose the edges of the polygon are $e_1, e_2, .., e_n$, we denote the lines corresponding to each edge as $l_1, l_2, .., l_n$. Each line in the plane can be represented by an equation:

\[
  \left\{
      \begin{array}{c}
          a_1 \cdot x + b_1 \cdot y + c = 0 \\
          a_2 \cdot x + b_2 \cdot y + c = 0 \\
          \cdots \\
          a_n \cdot x + b_n \cdot y + c = 0
      \end{array}
  \right.
\]

Each edge forms part of the boundary of the polygon, one side is inner of polygon, the other side is outer of polygon. However, as the polygon is not necessarily convex, there could be inner points lie on two sides of the line corresponding to the edge. If we traverse the polygon edges in clockwise order, we'll find that the inner side is always on the right hand of the edges. If we traverse the polygon edges in counter-clockwise order, the inner side is always on the left hand of the edges.

If we know the order how the vertices are represented in the doublely-linked list, we can easily calculate inner side of each edge in $O(n)$. If we don't know the order, we can use following trick to determine the order in linear time:

\begin{quote}
Sum over the edges, $\cfrac{x_{i+1}-x_i}{y_{i+1}-y_i}$. If the result is positive the curve is clockwise, if it's negative the curve is counter-clockwise.
\end{quote}

Suppose we get following result about the inner side of edges:

\[
  \left\{
      \begin{array}{c}
          a_1 \cdot x + b_1 \cdot y + c \leq 0 \\
          a_2 \cdot x + b_2 \cdot y + c \geq 0 \\
          \cdots \\
          a_n \cdot x + b_n \cdot y + c \geq 0
      \end{array}
  \right.
\]\\

Let's define $f(x, y) = x + y$ as the objective function, then we have a typical 2D linear programming problem at hand. Next we're going to show that the original problem is indeed equivalent to the 2D linear programming problem formulated above. As the expected cost of the standard algorithm for 2D linear programming problem is \~O(n) for n constraints, so the expected cost to determine the existence of point is also linear.\\

To prove that the two problem formulations are equivalent, we have to prove in both directions.\\

\textbf{1. Existence of Point $\Rightarrow$ Existence of Solution to LP Problem }\\

We prove by contradiction. Suppose there exists such a point P which is inside polygon and its links to vertices don't cross the boundary of polygon, and there's no solution to the LP problem. So the point P must violate at least one constraint $C_i$. Suppose the constraint correspond to edge AB, thus P is facing the outer side of edge AB.

Now consider the triangle PAB. From the fact that AB is an edge of polygon, PA and PB don't cross polygon boundary, we can infer that \textit{the whole area of triangle PAB must be inside polygon}. However, because P is facing the outer side of edge AB, so \textit{part of the triangle PAB must be outside of the polygon}. This is a contradition, so our original hypothesis holds. \\

\textbf{2. Existence of Solution to LP Problem $\Rightarrow$ Existence of Point }\\

Suppose point P $(x_0, y_0)$ is the solution to the LP problem. P must be within the polygon, as the inner side of the edge lines form a subset area of the polygon. P must be facing inner sides of all edges, or at least one constraint will be violated.

Now consider any vertex C. Because P is facing inner sides of the two edges which join at C, then we have:

\begin{itemize}
\item Segment PC is totally within the polygon, or
\item There exists at least one edge $e$ which cuts segment PC, and P is facing outer side of $e$.
\end{itemize}

We know P is facing inner side of all edges, so PC must be within polygon, i.e. PC doesn't cross polygon boundary. So P is the point we want to find.
